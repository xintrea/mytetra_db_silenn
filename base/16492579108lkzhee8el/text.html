<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Constantia'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Синхронизацию в MyTetra можно сделать с помощью следующих средств: </p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">облачных систем хранения данных (Яндекс.Диск, Google Drive, DropBox и т. д.);</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">систем контроля версий (Git, Svn, Mercurial и т. д.).</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Самое простой метод синхронизации - это разместить каталог с базой MyTetra в каталоге облачной системы хранения данных. Далее надо зайти в &quot;Настройки&quot; - &quot;Синхронизация&quot; и поставить флажок &quot;Периодическая проверка дерева записей на изменение сторонними программами&quot;. По такому методу работают многие пользователи, и даже есть группы людей, которые одновременно совместно работают над одной базой данных. При использовании такого механизма синхронизации желательно наличие хорошего интернет-канала.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Более сложный метод синхронизации - это синхронизация через систему контроля версий. Желательно, чтобы система онтроля версий поддерживала атомарность. Атомарность -  это такое свойство системы, при котором все файлы обновляются на состояние, соответсвующее одному моменту времени. Свойством атомарности обладает система контроля версий <span style=" font-weight:600;">Git</span>, и я использую её для синхронизации. В качестве хостинга я использую <a href="http://GitHub.com"><span style=" text-decoration: underline; color:#0000ff;">GitHub.com</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">GitHub.com предоставляет бесплатный тарифный план для хранения публичных репозитариев в открытом виде. На GitHub можно разместить и закрытые репозитарии, заплатив несколько долларов в месяц.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как MyTetra имеет встроенный механизм шифрования, то пользователь может разместить свои данные бесплатно и безопасно у всех на виду. В любом случае, на бесплатном аккаунте GitHub никто не сможет изменить данные пользователя - все создаваемые на GitHub репозитарии имеют режим только чтение (Read Only) для других пользователей. Пока не будут прописаны дополнительные пользователи, которые могут иметь доступ на запись в репозитарий, хранимым данным пользователя ничего не угрожает.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Что необходимо для синхронизации через Git</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Для того, чтобы сделать синхронизацию через git, нужно иметь две вещи: установленный git и аккаунт на GitHub. Тех, кто никогда не работал с git и GitHub, я отправляю читать статью (см. раздел <span style=" font-weight:600;">Git &amp; GitHub руководство</span>).</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Создание репозитария с данными MyTetra</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Перво-наперво нужно создать новый пустой репозитарий в системе GitHub. Далее будем считать, что для синхронизации вы создали репозитарий с именем mytetra. Создание репозитария производится в веб-интерфейсе GitHub.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Затем нужно выяснить, где находится на вашем компьютере директория с данными программы MyTetra.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Для версий до 1.44.154: </span>Запускаем MyTetra, нажимаем &quot;Инструменты&quot; -&gt; &quot;Настройки&quot; -&gt; &quot;Основные&quot;. В поле &quot;Директория с данными&quot; нажимаем кнопочку с тремя точками [...] и смотрим, где расположена директория /data.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Для версий 1.44.154 и выше: </span>В MyTetra появился менеджер баз данных. Запускаем MyTetra, нажимаем &quot;Файл&quot; - &quot;Управление базами данных&quot;. Смотрим, где расположена директория <span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">/data</span> выбранной базы данных.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Все дальнейшие действия из консоли следует выполнять внутри директории <span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">/data</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Итак, переходим в директорию <span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">/data</span> и даем следующие команды:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">git init</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">git add .</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">git commit -a -m &quot;first commit&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">git remote add origin git@github.com:username/mytetra.git</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">git push -u origin master</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вместо <span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">username</span> надо, естественно, написать свой GitHub-логин . В результате этих действий, в каталоге <span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">/data</span> появится подкаталог <span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">.git</span> - это системный каталог программы git. Если при выполнении команд не возникло ошибок, значит, начиная с этого момента, данные уже лежат на сервере GitHub. И их можно посмотреть через web-интерфейс системы GitHub.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-style:italic;">Помните, что заливая данные на GitHub, вы делаете их открытыми всему интернету! Поэтому, если у вас есть приватные данные, которые нельзя никому показывать, не забудьте предварительно их зашифровать! Шифровать данные нужно перед тем, как будете делать заливку на сервер, так как система git позволяет просматривать историю данных.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Настройка синхронизации MyTetra с сервером репозитария</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> В MyTetra, нажимаем &quot;Инструменты&quot; -&gt; &quot;Настройки&quot; -&gt; &quot;Синхронизация&quot;. Видим вот такие настройки:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image25435.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В поле &quot;Команда синхронизации&quot; задаем следующую команду.<br /><br /><span style=" font-weight:600;">Для пользователей Linux:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;"> cd %a ; git add . ; git commit -a -m MyTetraCommit ; git pull -s recursive ; git push</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Для пользователей Windows:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;"> cd \ &amp; cd &quot;%a&quot; &amp; git add . &amp; git commit -a -m MyTetraCommit &amp; git pull -s recursive &amp; git push</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Внимание!</span> Если данные находятся на диске, отличным от <span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">C:</span>, надо добавлять в команду смены каталога еще и смену диска. Например, вместо &quot;<span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">cd \</span>&quot; следует писать &quot;<span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;">cd D:\</span>&quot;.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> После чего добавляем в MyTetra пару записей, редактируем уже существующие, удаляем ненужные. Затем нажимаем на кнопку синхронизации, и, если всё в порядке, на сервере GitHub будут зафиксированы эти изменения.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Отладка</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Вопрос:</span> Что делать, если данные не уходят на сервер GitHub, а лог синхронизиции в окне синхронизации так быстро промелькивает, что ничего не успеваешь прочитать?</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Ответ:</span> В конец команды синхронизации добавьте команду, которая остановит вывод. Пользователи Linux могут добавить ; read. Пользователи Windows могут добавить &amp; pause 0. Внимательно прочитайте что написано в логе, возможно вы сразу поймете в чем причина неполадки.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Вопрос:</span> Что делать, если на этапе синхронизации окно синхронизации не закрывается самостоятельно, а чего-то ждет?</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Ответ:</span> Такое может возникнуть, если git пытается что-то запросить от пользователя через консольный ввод. Причем, самого запроса в логе может быть не видно. В этом случае выключаем MyTetra, переходим в каталог /data (вы уже знаете, где он находится), и начинаем последовательно выполнять команды из строки с командой синхронизации. Вначале выполняем:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;"> git add .</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Потом выполняем:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; font-size:10pt; color:#aa0000;"> git commit -a -m MyTetraCommit</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> И так далее. На какой-то команде может возникнуть какая-то ошибка. Обычно эта ошибка возникает из-за неправильного конфигурирования git или ключей шифрования. Исправляем ошибку, так же по шагам проверяем работу, и дальше в MyTetra всё должно работать без подобных плясок.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Синхронизация данных MyTetra с другими компьютерами</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Ранее мы рассмотрели, как сделать первичное наполнение данных в репозитарии, и как синхронизироваться с сервером. Но пока что мы получили только &quot;резервное копирование данных&quot; - ведь у нас настроено только одно место с синхронизируемыми данными.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Теперь нужно рассказать, как настроить второе (и все последующие места) для синхронизации данных. Под термином &quot;место&quot; следует понимать, к примеру, один компьютер. То есть, если у вас два компьютера - один домашний, другой на работе, и вам нужно иметь единую базу MyTetra, значит у вас две точки синхронизации, то есть два места, которые должны синхронизироваться друг с другом.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Внимание!</span> Здесь речь идет о <span style=" font-weight:600;">сихронизации</span> одного набора данных между несколькими копиями MyTetra. Если у вас на домашнем компьютере уже есть одна база данных, а на рабочем компьютере уже есть другая база данных, и вы хотите их объединить, то речь идет о <span style=" font-weight:600;">слиянии</span> баз. Процедуры слияния баз в MyTetra не предусмотрено. Возможно, кто-то захочет написать скрипт для слияния баз - пожалуйста сделайте его, если у вас есть возможности и желание.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Итак, на втором компьютере, где мы хотим сделать синхронизацию, инсталлируем MyTetra, выясняем месторасположение каталога /data  (как это сделать, написано выше). Выходим из MyTetra, затем заходим в каталог /data, <span style=" font-weight:600;">и всё в нём удаляем</span>. Затем, находясь в каталоге /data, даем команду:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> git clone git@github.com:<span style=" font-weight:600;">username</span>/mytetra.git .</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> где вместо username не забываем подставить свой логин на GitHub-е. Да-да, в конце этой команды стоит <span style=" font-weight:600;">пробел и точка</span>. Так нужно, чтобы данные закачались прямо в текущий каталог а не в подкаталог с именем репозитария. Данная команда выкачает с GitHub все данные в актуальном состоянии.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Признаком того, что данные закачались правильно</span>, будет наличие файла mytetra.xml, подкаталога /base и подкаталога /.git в каталоге /data. Так же возможно наличие других подкаталогов и файлов.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Далее запускаем MyTetra и видим, что она уже работает с полной копией данных, которые были получены с сервера GitHub. Далее в MyTetra, нажимаем &quot;Инструменты&quot; -&gt; &quot;Настройки&quot; -&gt; &quot;Синхронизация&quot;, и устанавливаем точно такую же команду синхронизации, которая написана в предыдущем разделе.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Всё! Теперь мы имеем две программы MyTetra, которые могут синхронизироваться друг с другом через сервер GitHub.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Особенности алгоритма синхронизации MyTetra</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Команды синхронизации, указанные выше, обеспечивают следующие принципы синхронизации.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> <span style=" font-weight:600;">Сервер главный</span>. Вся синхронизация идет относительно последних данных, хранящихся на сервере. В момент синхронизации сервер принимает от клиента изменения, котрые были сделаны пожже, чем последнее зафиксированное состояние файлов на сервере. А так же сервер выдает клиенту те изменения, которые клиент еще не получал.<br /><br /><span style=" font-weight:600;">Учитывается связанность по времени</span>. Грубо говоря, если вы в первой копии данных удалите ветку с записями и засинхронизируетесь, а во второй копии, не синхронизируясь начнете редактировать записи в этой ветке, то после синхронизации второй копии всё ваше редактирование будет забыто и ветка удалена. Это произойдет потому, что вначале произошло событие удаления ветки (и оно было зафиксировано!), а все последующие действия внутри этой ветки не имеют смысла.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> Помните, что пользуясь системой контроля версий git, вы всегда можете восстановить данные на конкретный момент времени. Как это делать - разбирайтесь сами, изучайте git и его команды - это очень мощная система.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"> </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>